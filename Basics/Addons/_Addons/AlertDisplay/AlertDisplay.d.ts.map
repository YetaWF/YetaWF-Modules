{"version":3,"sources":["AddOns/YetaWF/Basics/_Addons/AlertDisplay/AlertDisplay.tsx"],"names":[],"mappings":"AAKA,kBAAU,aAAa,CAAC;CAoEvB","file":"AlertDisplay.d.ts","sourcesContent":["/* Copyright Â© 2019 Softel vdm, Inc. - https://yetawf.com/Documentation/YetaWF/Basics#License */\r\n\r\n// If this javascript snippet is included, that means we're displaying the alert.\r\n// The alert is displayed until dismissed or if the page doesn't reference this module (dynamic content).\r\n\r\nnamespace YetaWF_Basics {\r\n\r\n    class AlertDisplayModule {\r\n\r\n        static readonly MODULEGUID: string = \"24b7dc07-e96a-409d-911f-47bffd38d0fc\";\r\n\r\n        static dismissed: boolean = false;\r\n        static on: boolean = true;\r\n\r\n        /**\r\n         * Initializes the module instance.\r\n         */\r\n        init(): void {\r\n            document.addEventListener(\"click\", this.handleClick);\r\n\r\n            $YetaWF.addWhenReady((section: HTMLElement): void => {\r\n                alert.initSection(section);\r\n            });\r\n\r\n            $YetaWF.registerContentChange((addonGuid:string, on:boolean):void => {\r\n                if (addonGuid === AlertDisplayModule.MODULEGUID) {\r\n                    AlertDisplayModule.on = on;\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Initializes all alert elements in the specified tag.\r\n         * @param tag - an element containing Alert elements.\r\n         */\r\n        initSection(tag: HTMLElement): void {\r\n            var alert: HTMLElement = document.querySelector(\".YetaWF_Basics_AlertDisplay\") as HTMLElement;\r\n            if (!alert) throw \".YetaWF_Basics_AlertDisplay not found\";/*DEBUG*/\r\n            if (!AlertDisplayModule.dismissed && AlertDisplayModule.on)\r\n                alert.style.display = \"\";\r\n            else\r\n                alert.style.display = \"none\";\r\n        }\r\n        /**\r\n         * Handles the click on the image to close the Alert.\r\n         * @param event\r\n         */\r\n        private handleClick(event: MouseEvent): void {\r\n            if (!$YetaWF.elementMatches(event.target as HTMLElement, \".YetaWF_Basics_AlertDisplay .t_close img\")) return;\r\n\r\n            AlertDisplayModule.dismissed = true;\r\n\r\n            var alert: HTMLElement = document.querySelector(\".YetaWF_Basics_AlertDisplay\") as HTMLElement;\r\n            if (!alert) throw \".YetaWF_Basics_AlertDisplay not found\";/*DEBUG*/\r\n\r\n            var close: Element | null = alert.querySelector(\".t_close\");\r\n            if (!close) throw \"No .t_close element found\";/*DEBUG*/\r\n            var ajaxurl: string | null = close.getAttribute(\"data-ajaxurl\");\r\n            if (!ajaxurl) throw \"No ajax url specified\";/*DEBUG*/\r\n\r\n            alert.style.display = \"none\";\r\n\r\n            // Save alert status server side\r\n            var request: XMLHttpRequest = new XMLHttpRequest();\r\n            request.open(\"POST\", ajaxurl, true);\r\n            request.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded; charset=UTF-8\");\r\n            request.send(\"\");\r\n            // we don't care about the result of this request\r\n        }\r\n    }\r\n\r\n    var alert: AlertDisplayModule = new AlertDisplayModule();\r\n    alert.init();\r\n}\r\n"]}