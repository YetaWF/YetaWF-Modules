{"version":3,"sources":["Addons/YetaWF/TawkTo/_Addons/SkinTawkTo/SkinTawkTo.ts"],"names":[],"mappings":"AAKA,QAAA,IAAI,QAAQ,EAAE,GAAG,CAAC;AAElB,kBAAU,aAAa,CAAC;IAEpB,UAAiB,eAAe;QAC5B,gBAAgB,EAAE,MAAM,CAAC;QACzB,gBAAgB,EAAE,MAAM,CAAC;KAC5B;CAqFJ","file":"SkinTawkTo.d.ts","sourcesContent":["/* Copyright Â© 2019 Softel vdm, Inc. - https://yetawf.com/Documentation/YetaWF/TawkTo#License */\r\n\r\n// If this javascript snippet is included, that means we're displaying the chat.\r\n\r\n// tslint:disable-next-line:variable-name\r\nvar Tawk_API: any;\r\n\r\nnamespace YetaWF_TawkTo {\r\n\r\n    export interface IPackageConfigs {\r\n        IncludedPagesCss: string;\r\n        ExcludedPagesCss: string;\r\n    }\r\n\r\n    class SkinTawkToModule {\r\n\r\n        static readonly MODULEGUID: string = \"c063e089-aff3-44e4-ac44-063911853579\";\r\n\r\n        static on: boolean = true;\r\n\r\n        /**\r\n         * Initializes the module instance.\r\n         */\r\n        init(): void {\r\n\r\n            var tawkto: SkinTawkToModule = this;\r\n\r\n            $YetaWF.registerContentChange((addonGuid: string, on: boolean): void => {\r\n                if (addonGuid === SkinTawkToModule.MODULEGUID) {\r\n                    SkinTawkToModule.on = on;\r\n                }\r\n            });\r\n\r\n            $YetaWF.registerNewPage((url: string): void => {\r\n                tawkto.showInvite(SkinTawkToModule.on);\r\n                if (SkinTawkToModule.on) {\r\n                    // Functionality not available in Tawk.to to record a new page\r\n                    //if (typeof ActivEngage !== \"undefined\" && ActivEngage !== undefined) {\r\n                    //    if (typeof ActivEngage.recordPageView !== \"undefined\" && ActivEngage.recordPageView !== undefined)\r\n                    //        ActivEngage.recordPageView({ \"href\": url });\r\n                    //}\r\n                }\r\n            });\r\n        }\r\n        /**\r\n         * Show/hide chat invite\r\n         * @param True to show, false to hide.\r\n         */\r\n        showInvite(show: boolean): void {\r\n\r\n            if (!Tawk_API || !Tawk_API.showWidget) return; // not yet initialized\r\n\r\n            var body: HTMLElement = document.querySelector(\"body\") as HTMLElement;\r\n            if (!body) return;\r\n\r\n            var invite: boolean = show;\r\n            if (invite) {\r\n                var inclCss = YConfigs.YetaWF_TawkTo.IncludedPagesCss;\r\n                var exclCss = YConfigs.YetaWF_TawkTo.ExcludedPagesCss;\r\n                if (inclCss && inclCss.length > 0) {\r\n                    // only included css pages show the chat invite\r\n                    invite = false;\r\n                    if (inclCss) {\r\n                        var csses: string[] = inclCss.split(\" \");\r\n                        for (var css of csses) {\r\n                            if ($YetaWF.elementHasClass(body, css)) {\r\n                                invite = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                // now check if page is explicitly excluded\r\n                if (exclCss && invite) {\r\n                    csses = exclCss.split(\" \");\r\n                    for (css of csses) {\r\n                        if ($YetaWF.elementHasClass(body, css)) {\r\n                            invite = false;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (!invite && show) {\r\n                if (Tawk_API.isVisitorEngaged())\r\n                    invite = true;\r\n            }\r\n            if (invite) {\r\n                Tawk_API.showWidget();\r\n            } else {\r\n                Tawk_API.hideWidget();\r\n            }\r\n        }\r\n    }\r\n\r\n    var tawkto: SkinTawkToModule = new SkinTawkToModule();\r\n    tawkto.init();\r\n}\r\n"]}