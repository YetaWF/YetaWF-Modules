{"version":3,"sources":["AddOns/YetaWF/Feed/_Main/Feed.ts"],"names":[],"mappings":"AAEA,kBAAU,WAAW,CAAC;IAElB,UAAU,KAAK;QACX,QAAQ,EAAE,MAAM,CAAC;KACpB;IAED,MAAa,IAAI;QAEb,OAAO,CAAC,GAAG,CAAiB;QAC5B,OAAO,CAAC,SAAS,CAAiB;QAClC,OAAO,CAAC,SAAS,CAAa;QAC9B,OAAO,CAAC,OAAO,CAAsB;QAErC,OAAO,CAAC,UAAU,CAAuB;oBAE7B,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK;QA0BvC,OAAO,CAAC,WAAW;KAkBtB;CACJ","file":"Feed.d.ts","sourcesContent":["/* Copyright ï¿½ 2019 Softel vdm, Inc. - https://yetawf.com/Documentation/YetaWF/Feed#License */\r\n\r\nnamespace YetaWF_Feed {\r\n\r\n    interface Setup {\r\n        Interval: number;\r\n    }\r\n\r\n    export class Feed {\r\n\r\n        private Div: HTMLDivElement;\r\n        private DivHeader: HTMLDivElement;\r\n        private NextEntry: number = 0;\r\n        private Entries: HTMLAnchorElement[];\r\n\r\n        private EntryTimer: number | null = null;\r\n\r\n        constructor(divId: string, setup: Setup) {\r\n\r\n            this.Div = $YetaWF.getElementById(divId) as HTMLDivElement;\r\n            this.DivHeader = $YetaWF.getElement1BySelector(\".t_headerentry\", [this.Div]) as HTMLDivElement;\r\n            this.Entries = $YetaWF.getElementsBySelector(\".t_entry a\", [this.Div]) as HTMLAnchorElement[];\r\n\r\n            this.changeEntry();\r\n            if (setup.Interval)\r\n                this.EntryTimer = setInterval(() => { this.changeEntry(); }, setup.Interval);\r\n\r\n            // change all a tags to open a new window\r\n            var elems = $YetaWF.getElementsBySelector(\"a\", [this.Div]);\r\n            for (let elem of elems) {\r\n                $YetaWF.setAttribute(elem, \"target\", \"_blank\");\r\n                $YetaWF.setAttribute(elem, \"rel\", \"noopener noreferrer\");\r\n            }\r\n\r\n            // Listen for events that the page is changing\r\n            $YetaWF.registerPageChange((): void => {\r\n                // when the page is removed, we need to clean up\r\n                if (this.EntryTimer) {\r\n                    clearInterval(this.EntryTimer);\r\n                    this.EntryTimer = null;\r\n                }\r\n            });\r\n        }\r\n        private changeEntry(): void {\r\n\r\n            var entry = this.Entries[this.NextEntry];\r\n\r\n            var newsEntry = `<a class='t_title' href='${entry.href}' target='_blank' rel='noopener noreferrer'>${entry.innerText}</a>`;\r\n            var text = $YetaWF.getAttributeCond(entry, \"data-text\") || \"\";\r\n            newsEntry += `<div class='t_text'>${text}</div>`;\r\n            var author = $YetaWF.getAttributeCond(entry, \"data-author\") || \"\";\r\n            newsEntry += `<div class='t_author'>${author}</div>`;\r\n            var formattedDate = $YetaWF.getAttributeCond(entry, \"data-publishedDate\") || \"\";\r\n            newsEntry += `<div class='t_date'>${formattedDate}</div>`;\r\n\r\n            this.DivHeader.innerHTML = newsEntry;\r\n\r\n            ++this.NextEntry;\r\n            if (this.NextEntry >= this.Entries.length)\r\n                this.NextEntry = 0;\r\n        }\r\n    }\r\n}\r\n\r\n"]}