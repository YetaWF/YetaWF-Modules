{"version":3,"sources":["Addons/YetaWF/ComponentsHTML/_Addons/Modules/Modules.ts"],"names":[],"mappings":"AAEA,kBAAU,qBAAqB,CAAC;IAE5B,MAAa,WAAW;QAEpB,OAAc,aAAa,EAAE,MAAM,CAAK;QAExC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAgB;eAEnC,UAAU,CAAC,KAAK,EAAE,OAAO,GAAG,IAAI;eA6BhC,0BAA0B,IAAI,IAAI;QAiBhD,OAAO,CAAC,MAAM,CAAC,wBAAwB;QA4BvC,OAAO,CAAC,MAAM,CAAC,wBAAwB;QAcvC,0DAA0D;QAC1D,OAAO,CAAC,MAAM,CAAC,0BAA0B;KAW5C;CAGJ","file":"Modules.d.ts","sourcesContent":["/* Copyright Â© 2019 Softel vdm, Inc. - https://yetawf.com/Documentation/YetaWF/ComponentsHTML#License */\r\n\r\nnamespace YetaWF_ComponentsHTML {\r\n\r\n    export class MenuHandler {\r\n\r\n        public static ClearInterval: number = 0;\r\n\r\n        private static readonly ClearTime: number = 1000;\r\n\r\n        public static clearMenus(quick: boolean): void {\r\n\r\n            // clear the interval\r\n            if (MenuHandler.ClearInterval)\r\n                clearInterval(MenuHandler.ClearInterval);\r\n            MenuHandler.ClearInterval = 0;\r\n\r\n            if (!quick) {\r\n                // if we still have a current module, we can't clear menus\r\n                if ($YetaWF.getElement1BySelectorCond(\".yModule.yModule-current\")) {\r\n                    MenuHandler.ClearInterval = setInterval((): void => { MenuHandler.clearMenus(false); }, MenuHandler.ClearTime);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            var editIcons = $YetaWF.getElementsBySelector(\".yModuleMenuEditIcon\");\r\n            if (editIcons.length) {\r\n                var menus = $YetaWF.getElementsBySelector(\".yModuleMenu\");\r\n                // hide all module menus\r\n                for (let menu of menus) {\r\n                    menu.style.display = \"none\";\r\n                }\r\n                // hide all edit icons\r\n                for (let editIcon of editIcons) {\r\n                    editIcon.style.display = \"none\";\r\n                }\r\n            }\r\n        }\r\n\r\n        public static registerMouseEnterHandlers(): void {\r\n            var mods = $YetaWF.getElementsBySelector(\".yModule\");\r\n            for (let mod of mods) {\r\n                $YetaWF.registerEventHandler(mod, \"mouseenter\", null, (ev: MouseEvent): boolean => {\r\n                    return MenuHandler.onHandleModuleMouseEnter(ev);\r\n                });\r\n                $YetaWF.registerEventHandler(mod, \"mouseleave\", null, (ev: MouseEvent): boolean => {\r\n                    return MenuHandler.onHandleModuleMouseLeave(ev);\r\n                });\r\n            }\r\n            var editIcons = $YetaWF.getElementsBySelector(\".yModuleMenuEditIcon\");\r\n            for (let editIcon of editIcons) {\r\n                $YetaWF.registerEventHandler(editIcon, \"mouseenter\", null, (ev: MouseEvent): boolean => {\r\n                    return MenuHandler.onHandleEditIconMouseEnter(ev);\r\n                });\r\n            }\r\n        }\r\n        private static onHandleModuleMouseEnter(ev: MouseEvent): boolean {\r\n\r\n            //console.log(\"Entering module\");\r\n\r\n            if (MenuHandler.ClearInterval)\r\n                clearInterval(MenuHandler.ClearInterval);\r\n            MenuHandler.ClearInterval = 0;\r\n\r\n            var modDiv = ev.__YetaWFElem as HTMLDivElement;\r\n\r\n            // add a class to the module to identify it's the current module\r\n            $YetaWF.elementRemoveClass(modDiv, \"yModule-current\");\r\n            $YetaWF.elementAddClass(modDiv, \"yModule-current\");\r\n\r\n            // find the module's edit icon\r\n            var editIcon = $YetaWF.getElement1BySelectorCond(\".yModuleMenuEditIcon\", [modDiv]);\r\n            if (editIcon) {\r\n\r\n                // entered a new module - clear all module menus that may be open\r\n                MenuHandler.clearMenus(true);\r\n\r\n                // fade in edit icon\r\n                ComponentsHTMLHelper.fadeIn(editIcon, 500);\r\n            }\r\n            MenuHandler.ClearInterval = setInterval((): void => { MenuHandler.clearMenus(false); }, MenuHandler.ClearTime);\r\n\r\n            return true;\r\n        }\r\n        private static onHandleModuleMouseLeave(ev: MouseEvent): boolean {\r\n\r\n            //console.log(\"Exiting module\");\r\n\r\n            if (MenuHandler.ClearInterval)\r\n                clearInterval(MenuHandler.ClearInterval);\r\n            MenuHandler.ClearInterval = setInterval((): void => { MenuHandler.clearMenus(false); }, MenuHandler.ClearTime);\r\n\r\n            var modDiv = ev.__YetaWFElem as HTMLDivElement;\r\n            $YetaWF.elementRemoveClass(modDiv, \"yModule-current\");\r\n\r\n            return true;\r\n        }\r\n\r\n        /** Show/hide menu as we're hovering over the edit icon */\r\n        private static onHandleEditIconMouseEnter(ev: MouseEvent): boolean {\r\n\r\n            //console.log(\"Entering edit icon\");\r\n\r\n            var modDiv = ev.__YetaWFElem as HTMLDivElement;\r\n            // find the module's menu\r\n            var menu = $YetaWF.getElement1BySelector(\".yModuleMenu\", [modDiv]);\r\n\r\n            menu.style.display = \"\";\r\n            return true;\r\n        }\r\n    }\r\n\r\n    MenuHandler.registerMouseEnterHandlers();\r\n}"]}