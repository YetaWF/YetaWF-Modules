{"version":3,"sources":["Addons/YetaWF/ComponentsHTML/_Templates/TextArea/TextArea.ts"],"names":[],"mappings":"AAEA,OAAO,CAAC,IAAI,QAAQ,EAAE,GAAG,CAAC;AAE1B,kBAAU,qBAAqB,CAAC;IAE5B,MAAa,qBAAqB;KAEjC;CAgDJ","file":"TextArea.d.ts","sourcesContent":["/* Copyright Â© 2019 Softel vdm, Inc. - https://yetawf.com/Documentation/YetaWF/ComponentsHTML#License */\r\n\r\ndeclare var CKEDITOR: any;\r\n\r\nnamespace YetaWF_ComponentsHTML {\r\n\r\n    export class TextAreaEditComponent {\r\n\r\n    }\r\n\r\n    // Override the built-in Save button to use our Form submit\r\n    // Need to wait for the ckeditor instance to finish initialization\r\n    // because CKEDITOR.instances.editor.commands is an empty object\r\n    // if you try to use it immediately after CKEDITOR.replace('editor');\r\n\r\n    if (typeof CKEDITOR !== \"undefined\") { // CKEDITOR is only defined when an editable textarea is used\r\n\r\n        CKEDITOR.on(\"instanceReady\", (ev: any): void => {\r\n\r\n            // Replace the old save's exec function with the new one\r\n            if (ev.editor.commands.save) {\r\n                // Create a new command with the desired exec function\r\n                var overridecmd = new CKEDITOR.command(ev.editor, {\r\n                    exec: (editor: any): void => {\r\n                        var $form = $(editor.element.$).closest(\"form.\" + YConfigs.Forms.CssFormAjax);\r\n                        if ($form.length !== 1) throw \"Couldn't find form\";/*DEBUG*/\r\n                        $YetaWF.Forms.submit($form[0], false);\r\n                    }\r\n                });\r\n\r\n                ev.editor.commands.save.exec = overridecmd.exec;\r\n            }\r\n        });\r\n    }\r\n\r\n    // when a tab page is switched, resize all the ckeditors in the newly visible panel (custom event)\r\n    // when we're in a float div (property list or tabbed property list) the parent width isn't available until after the\r\n    // page has completely loaded, so we need to set it again.\r\n    // For other cases (outside float div) this does no harm and resizes to the current size.\r\n\r\n    $YetaWF.registerActivateDiv((div: HTMLElement): void => {\r\n        var ckeds = $YetaWF.getElementsBySelector(\".yt_textarea.t_edit\", [div]);\r\n        for (let cked of ckeds) {\r\n            var ck = CKEDITOR.instances[cked.id];\r\n            ck.resize(\"100%\", $YetaWF.getAttribute(cked, \"data-height\"), true);\r\n        }\r\n    });\r\n\r\n    // A <div> is being emptied. Destroy all ckeditors the <div> may contain.\r\n    $YetaWF.registerClearDiv((tag: HTMLElement): void => {\r\n        var list = $YetaWF.getElementsBySelector(\"textarea.yt_textarea\", [tag]);\r\n        for (let el of list) {\r\n            if (CKEDITOR.instances[el.id])\r\n                CKEDITOR.instances[el.id].destroy();\r\n        }\r\n    });\r\n}\r\n\r\n\r\n\r\n"]}