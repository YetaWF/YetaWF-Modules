{"version":3,"sources":["Addons/YetaWF/ComponentsHTML/_Templates/Image/ImageEdit.ts"],"names":[],"mappings":"AAEA,kBAAU,qBAAqB,CAAC;IAE5B,UAAU,cAAc;QACpB,QAAQ,EAAE,MAAM,CAAC;KACpB;IAED,MAAa,kBAAmB,SAAQ,MAAM,CAAC,iBAAiB;QAE5D,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAuB;QAE1D,OAAO,CAAC,KAAK,CAAiB;QAC9B,OAAO,CAAC,aAAa,CAAuB;QAC5C,OAAO,CAAC,UAAU,CAAmB;QACrC,OAAO,CAAC,WAAW,CAAmB;QACtC,OAAO,CAAC,YAAY,CAAiB;oBAEzB,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,cAAc;QA8BpD,OAAO,CAAC,aAAa;QAKrB,OAAO,CAAC,UAAU;KAMrB;CACJ","file":"ImageEdit.d.ts","sourcesContent":["/* Copyright Â© 2019 Softel vdm, Inc. - https://yetawf.com/Documentation/YetaWF/ComponentsHTML#License */\r\n\r\nnamespace YetaWF_ComponentsHTML {\r\n\r\n    interface ImageEditSetup {\r\n        UploadId: string;\r\n    }\r\n\r\n    export class ImageEditComponent extends YetaWF.ComponentBaseImpl {\r\n\r\n        private static readonly CLEAREDFILE: string = \"(CLEARED)\";\r\n\r\n        private Setup: ImageEditSetup;\r\n        private UploadControl: FileUpload1Component;\r\n        private PreviewImg: HTMLImageElement;\r\n        private HiddenInput: HTMLInputElement;\r\n        private HaveImageDiv: HTMLDivElement;\r\n\r\n        constructor(controlId: string, setup: ImageEditSetup) {\r\n            super(controlId);\r\n            this.Setup = setup;\r\n\r\n            this.UploadControl = YetaWF.ComponentBaseDataImpl.getControlById(this.Setup.UploadId, FileUpload1Component.SELECTOR);\r\n            this.PreviewImg = $YetaWF.getElement1BySelector(\".t_preview\", [this.Control]) as HTMLImageElement;\r\n            this.HiddenInput = $YetaWF.getElement1BySelector(\"input[type='hidden']\", [this.Control]) as HTMLInputElement;\r\n            this.HaveImageDiv = $YetaWF.getElement1BySelector(\".t_haveimage\", [this.Control]) as HTMLDivElement;\r\n\r\n            if (this.HiddenInput.value === ImageEditComponent.CLEAREDFILE)\r\n                this.HiddenInput.value = \"\";\r\n\r\n            // set upload control settings\r\n            this.UploadControl.SetSuccessfullUpload((data: FileUploadResponse): void => {\r\n                this.HiddenInput.value = data.FileName;\r\n                this.setPreview(data.FileName);\r\n                this.HaveImageDiv.style.display = data.FileName.length > 0 ? \"block\" : \"none\";\r\n            });\r\n            this.UploadControl.SetGetFileName((): string => { return this.HiddenInput.value; });\r\n\r\n            // handle the clear button\r\n            $YetaWF.registerEventHandler(this.Control, \"click\", \"input.t_clear\", (ev: MouseEvent):boolean => {\r\n                this.UploadControl.RemoveFile(this.HiddenInput.value);\r\n                this.clearFileName();\r\n                return false;\r\n            });\r\n\r\n            if (this.HiddenInput.value.length === 0)\r\n                this.clearFileName();\r\n        }\r\n        private clearFileName(): void {\r\n            this.HiddenInput.value = ImageEditComponent.CLEAREDFILE;\r\n            this.setPreview(\"\");\r\n            this.HaveImageDiv.style.display = \"none\";\r\n        }\r\n        private setPreview(name: string): void {\r\n            var currUri = $YetaWF.parseUrl(this.PreviewImg.src);\r\n            currUri.removeSearch(\"Name\");\r\n            currUri.addSearch(\"Name\", name);\r\n            this.PreviewImg.src = currUri.toUrl();\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n"]}