{"version":3,"sources":["AddOns/YetaWF/ComponentsHTML/_Templates/ModuleSelection/ModuleSelectionEdit.ts"],"names":[],"mappings":"AAEA,kBAAU,qBAAqB,CAAC;IAE5B,UAAU,KAAK;QACX,OAAO,EAAE,MAAM,CAAC;QAChB,eAAe,EAAE,MAAM,CAAC;KAC3B;IAED,MAAa,4BAA6B,SAAQ,MAAM,CAAC,qBAAqB;QAE1E,OAAc,QAAQ,EAAE,MAAM,CAAgC;QAE9D,OAAO,CAAC,KAAK,CAAQ;QACrB,OAAO,CAAC,aAAa,CAAkD;QACvE,OAAO,CAAC,YAAY,CAAkD;QACtE,OAAO,CAAC,cAAc,CAAiB;QACvC,OAAO,CAAC,OAAO,CAAiB;QAChC,OAAO,CAAC,KAAK,CAAoB;oBAErB,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK;QAqB3C,OAAO,CAAC,eAAe;QAavB,OAAO,CAAC,kBAAkB;iBAMtB,QAAQ,EAAI,OAAO;iBAInB,KAAK,EAAI,MAAM;QAGZ,MAAM,CAAC,OAAO,EAAE,OAAO,GAAG,IAAI;QAW9B,KAAK,IAAI,IAAI;QAKb,UAAU,CAAC,IAAI,EAAE,MAAM,GAAG,OAAO;QAKxC;;WAEG;QACI,cAAc,CAAC,OAAO,EAAE,MAAM,GAAG,IAAI;KAqB/C;CAKJ","file":"ModuleSelectionEdit.d.ts","sourcesContent":["/* Copyright Â© 2019 Softel vdm, Inc. - https://yetawf.com/Documentation/YetaWF/ComponentsHTML#License */\r\n\r\nnamespace YetaWF_ComponentsHTML {\r\n\r\n    interface Setup {\r\n        AjaxUrl: string;\r\n        AjaxUrlComplete: string;\r\n    }\r\n\r\n    export class ModuleSelectionEditComponent extends YetaWF.ComponentBaseDataImpl {\r\n\r\n        public static SELECTOR: string = \".yt_moduleselection.t_edit\";\r\n\r\n        private Setup: Setup;\r\n        private SelectPackage: YetaWF_ComponentsHTML.DropDownListEditComponent;\r\n        private SelectModule: YetaWF_ComponentsHTML.DropDownListEditComponent;\r\n        private DivDescription: HTMLDivElement;\r\n        private DivLink: HTMLDivElement;\r\n        private ALink: HTMLAnchorElement;\r\n\r\n        constructor(controlId: string, setup: Setup) {\r\n            super(controlId);\r\n            this.Setup = setup;\r\n\r\n            this.SelectPackage = YetaWF.ComponentBaseDataImpl.getControlFromSelector(\".t_packages select\", DropDownListEditComponent.SELECTOR, [this.Control]);\r\n            this.SelectModule = YetaWF.ComponentBaseDataImpl.getControlFromSelector(\".t_select select\", DropDownListEditComponent.SELECTOR, [this.Control]);\r\n            this.DivDescription = $YetaWF.getElement1BySelector(\".t_description\", [this.Control]) as HTMLDivElement;\r\n            this.DivLink = $YetaWF.getElement1BySelector(\".t_link\", [this.Control]) as HTMLDivElement;\r\n            this.ALink = $YetaWF.getElement1BySelector(\"a\", [this.DivLink ]) as HTMLAnchorElement;\r\n\r\n            this.showDescription();\r\n\r\n            this.SelectPackage.Control.addEventListener(\"dropdownlist_change\", (evt: Event): void => {\r\n                var data = { AreaName: this.SelectPackage.value };\r\n                this.SelectModule.ajaxUpdate(data, this.Setup.AjaxUrl);\r\n            });\r\n            this.SelectModule.Control.addEventListener(\"dropdownlist_change\", (evt: Event): void => {\r\n                this.showDescription();\r\n            });\r\n        }\r\n\r\n        private showDescription(): void {\r\n            var modGuid = this.SelectModule.value;\r\n            if (this.hasValue) {\r\n                this.ALink.href = \"/!Mod/\" + modGuid; // Globals.ModuleUrl\r\n                this.ALink.style.display = \"inline-block\";\r\n                this.DivDescription.textContent = this.getDescriptionText();\r\n                this.DivDescription.style.display = \"block\";\r\n            } else {\r\n                this.ALink.style.display = \"none\";\r\n                this.DivDescription.style.display = \"none\";\r\n                this.DivDescription.textContent = \"\";\r\n            }\r\n        }\r\n        private getDescriptionText(): string | null {\r\n            return this.SelectModule.getToolTip(this.SelectModule.selectedIndex);\r\n        }\r\n\r\n        // API\r\n\r\n        get hasValue(): boolean {\r\n            var modGuid = this.SelectModule.value;\r\n            return (modGuid !== undefined && modGuid !== null && modGuid.length > 0 && modGuid !== \"00000000-0000-0000-0000-000000000000\");\r\n        }\r\n        get value(): string {\r\n            return this.SelectModule.value;\r\n        }\r\n        public enable(enabled: boolean): void {\r\n            this.SelectPackage.enable(enabled);\r\n            this.SelectModule.enable(enabled);\r\n            if (enabled && this.hasValue) {\r\n                this.ALink.style.display = \"inline-block\";\r\n                this.DivDescription.style.display = \"block\";\r\n            } else {\r\n                this.ALink.style.display = \"none\";\r\n                this.DivDescription.style.display = \"none\";\r\n            }\r\n        }\r\n        public clear(): void {\r\n            this.SelectPackage.value = \"\";\r\n            this.SelectModule.value = \"\";\r\n            this.showDescription();\r\n        }\r\n        public hasChanged(data: string): boolean {\r\n            if (!this.hasValue) return false;\r\n            var modGuid = this.SelectModule.value;\r\n            return modGuid !== data;\r\n        }\r\n        /**\r\n         * Load object with data. Selects the correct package in the dropdownlist and selects the module (the package is detected using ajax).\r\n         */\r\n        public updateComplete(modGuid: string): void {\r\n\r\n            if (modGuid !== undefined && modGuid !== null && modGuid.length > 0 && modGuid !== \"00000000-0000-0000-0000-000000000000\") {\r\n\r\n                var data = { \"modGuid\": modGuid };\r\n                this.SelectModule.ajaxUpdate(data, this.Setup.AjaxUrlComplete,\r\n                    (data: any): void => {\r\n                        this.SelectPackage.value = data.extra;\r\n                        this.SelectModule.value = modGuid;\r\n                        this.showDescription();\r\n                        FormsSupport.validateElement(this.SelectModule.Control);\r\n                    },\r\n                    (result: string): void => {\r\n                        this.clear();\r\n                        FormsSupport.validateElement(this.SelectModule.Control);\r\n                    }\r\n                );\r\n            } else {\r\n                this.clear();\r\n            }\r\n        }\r\n    }\r\n    // A <div> is being emptied. Destroy all controls the <div> may contain.\r\n    $YetaWF.registerClearDiv((tag: HTMLElement): void => {\r\n        ModuleSelectionEditComponent.clearDiv<ModuleSelectionEditComponent>(tag, ModuleSelectionEditComponent.SELECTOR);\r\n    });\r\n}\r\n\r\n\r\n"]}